# Learning Log 2
![Ready Trader Go](/assets/images/ready-trader-go.jpg)

## Current goals
- Compare performance of our two autotraders and identify the most profitable autotrader

## What have you done
### Comparing basic z_score strategy and moving averages strategy
My partner for this project has further developed the basic trading strategy so that it incorporates moving averages in an attempt to increase profits. Now the development of this is completed we need to assess which of our two autotraders is more profitable and be the autotrader that we focus our development on. In order to do this, I have run the two autotrader strategies independently on each of the four market data sets provided, recording the profits generated and any general observations. I also adjusted the parameters of the two algorithms to see how they act with different z_score thresholds and moving averages periods.

Across the four sets of market data, which gives us a total of 1 hour’s trading, the basic z_score threshold strategy was the more profitable strategy. However, the z_score strategy did not make a single trade when using market data 4. Whereas the rolling average strategy had no problem making trades for this market data. The z_score strategy produced the most profit for data set two and three when the z_score was set optimally and the best profit the strategy produced for market data 1 was only $30 off the moving averages strategy profits. The z_score strategy appears to be the more profitable strategy and as such this is the strategy we will be developing further.
![z_score profits](/assets/images/z_score_profits.png)<br>
Profits of the z_score strategy for different z_score thresholds.
![moving averages profits](/assets/images/moving_averages_profits.png)<br>
Profits for the moving averages strategy with different parameters

Since there are over 45,000 trades carried out in the order books of the ETF and Future combined the parameters of any trading strategy can make the difference between a profitable and loss-making strategy. This is especially key for the moving averages strategy since the ratio of your short term and long-term averages needs to be a valid reflection of the market trends. If the short-term and long-term moving averages are too similar, then the comparison is invalid as there will never be a deviation. For the moving averages strategy, the short-term trend is calculated by taking x number of past orders and taking their average, similarly the long-term average is calculated in the same way but taking y number of past orders. Changing the values of x and y will alter the accuracy of the moving average trend. For the z_score autotrading strategy the only parameter is the z_score threshold at which a trade is executed.

When carrying out iterative testing on the moving averages strategy it was possible to draw some conclusions about the optimum values for x and y. The greatest profits were made when the value of x was low. Specifically, an x value of 5 was a good indicator of a profitable setting. Changing y did not have much of an impact on profitability providing x was a low value around 5. I also looked at the effect of varying the spread between x and y. A large spread was not good for profits and is shown by the red at the bottom section of the chart. The best profits were made when x was 5 and y 100. This means the short-term average is looking back over 5 price values and the long-term average is looking back over 100 prices values. However, results were similar for other parameters.
![moving averages profits](/assets/images/moving_averages_profits.png)<br>

For the z_score trading strategy I ran tests on all 4 data sets varying the threshold that a trade is executed from 0.25 up to 3. A z_score threshold of 1.75 and above saw profits decrease rapidly. Whilst strong profits were made with a threshold in the region of 0.75 to 1.5. Trading with a threshold of 1.25 saw the biggest profits producing the maximum profit for data sets 2 and 3 and the second greatest profit for data set 3. Interestingly the algorithm did not execute any trades for market data 4 which will need to be investigated and fixed. Compared to using the moving averages strategy this strategy was more consistent with less variance. The best threshold value was consistent for all the data sets whereas with moving averages the best x and y values depended on the data set being used.
![z_score profits](/assets/images/z_score_profits.png)<br>

After discussion with my teammate, we decided that we will be moving forward with the original z_score strategy. This was because profits were more consistent across the different data sets when using a z_score of 1.25 and also due to the fact that the average profit was as good as if not better than the moving averages strategy. We believe that there is also the potential to write the algorithm more efficiently leading to a faster auto trader.

## What have you learnt
Analysing the performance of these two algorithms showed me that you need to consider many factors when comparing algorithms. The key characteristics that I decided to focus on were as follows maximum profit, average profit, variance. For my analysis I was adjusting the parameters manually. However, if I was to do this again, I would have written some code to adjust parameters automatically and keep tweaking them until they reached the optimum value since this would be less time consuming and also lead to more accurate results.

Conducting this analysis for the standard z_score strategy was trivial as I could simply change the threshold parameter. Since there was only one parameter to change, the threshold at which a trade is executed, it was easy to see how this related to profit. There was a consistent trend towards better profits as the threshold converged towards 1.25. However, since the moving averages strategy had two parameters it was tricker to immediately see a trend. Measuring the ratio and spread between x and y helped me to think about what values I should test x and y for. I wanted to establish what a high or low x or y value would do to profits and see if a small or large ratio was optimum whilst also looking at if a large or small spread was desired. It was quickly seen that a large spread was not desirable. The maximum ratio that would carry out trades was 0.5 with anything larger than this not allowing the moving averages to diverge enough to initiate a trade.

I learnt that optimising parameters of an algorithm is a complex problem that quickly becomes an exponential problem. A change in one variable will affect how the others behave meaning each time you test a new parameter value you then need to conduct all your testing again to see how this has affected the other parameters. This all makes it harder to see a specific trend and was another reason we chose to stick with the z_score autotrader since it’s much easier to see how changing the threshold directly affected profits. We could have spent a lot of time attempting to find the optimum implementation of a rolling averages strategy without any guarantee that it would outperform the z_score strategy.

At this stage of development, we had a main branch containing the z_score strategy and another development branch containing the moving averages version of our autotrader. Swapping between these two branches taught me about using "git stash" to record changes you have made to a branch without making a commit but still going to a clean working directory. This came in handy when I was adjusting parameters and flicking between the two branches but did not want to commit any of these changes until I was confident in my work.

## Next steps to achieve your goals
For the final development log, I am going to look at increasing the efficiency of the z_score algorithm from a python implementation perspective. Using some more efficient data structures along with only calculating and storing required values should help to speed up our algorithm. This should in turn increase profits as the algorithm will be able to make a trade the moment a spread is detected at the best available price.